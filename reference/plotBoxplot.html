<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot Boxplots for Top Loading Gene Shifts (Two-Panel Summary using ggplot2) — plotBoxplot • scDiagnostics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot Boxplots for Top Loading Gene Shifts (Two-Panel Summary using ggplot2) — plotBoxplot"><meta property="og:description" content="This internal helper function creates a comprehensive two-panel summary plot
displaying gene expression distributions and principal component loadings.
The visualization uses ggplot2 faceting to create side-by-side panels.
Optionally includes anomaly status information using visual cues."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scDiagnostics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/scDiagnostics.html">Getting Started with scDiagnostics</a>
    </li>
    <li>
      <a href="../articles/VisualizationTools.html">Visualization of Cell Type Annotations</a>
    </li>
    <li>
      <a href="../articles/DatasetMarkerGeneAlignment.html">Evaluation of Dataset and Marker Gene Alignment</a>
    </li>
    <li>
      <a href="../articles/AnnotationAnomalies.html">Detection and Analysis of Annotation Anomalies</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ccb-hms/scDiagnostics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot Boxplots for Top Loading Gene Shifts (Two-Panel Summary using ggplot2)</h1>
    <small class="dont-index">Source: <a href="https://github.com/ccb-hms/scDiagnostics/blob/main/R/plot.calculateTopLoadingGeneShiftsObject.R" class="external-link"><code>R/plot.calculateTopLoadingGeneShiftsObject.R</code></a></small>
    <div class="hidden name"><code>plotBoxplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This internal helper function creates a comprehensive two-panel summary plot
displaying gene expression distributions and principal component loadings.
The visualization uses ggplot2 faceting to create side-by-side panels.
Optionally includes anomaly status information using visual cues.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotBoxplot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">cell_type</span>,</span>
<span>  <span class="va">available_pcs</span>,</span>
<span>  <span class="va">plot_by</span>,</span>
<span>  <span class="va">n_genes</span>,</span>
<span>  <span class="va">significance_threshold</span>,</span>
<span>  <span class="va">show_anomalies</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>calculateTopLoadingGeneShiftsObject</code> containing
expression data and analysis results.</p></dd>


<dt id="arg-cell-type">cell_type<a class="anchor" aria-label="anchor" href="#arg-cell-type"></a></dt>
<dd><p>A character string specifying the cell type to visualize.</p></dd>


<dt id="arg-available-pcs">available_pcs<a class="anchor" aria-label="anchor" href="#arg-available-pcs"></a></dt>
<dd><p>A character vector of principal components to include in analysis.</p></dd>


<dt id="arg-plot-by">plot_by<a class="anchor" aria-label="anchor" href="#arg-plot-by"></a></dt>
<dd><p>A character string indicating gene selection criterion ("top_loading" or "p_adjusted").</p></dd>


<dt id="arg-n-genes">n_genes<a class="anchor" aria-label="anchor" href="#arg-n-genes"></a></dt>
<dd><p>An integer specifying the number of top genes to display per PC.</p></dd>


<dt id="arg-significance-threshold">significance_threshold<a class="anchor" aria-label="anchor" href="#arg-significance-threshold"></a></dt>
<dd><p>A numeric value between 0 and 1 for significance annotation.</p></dd>


<dt id="arg-show-anomalies">show_anomalies<a class="anchor" aria-label="anchor" href="#arg-show-anomalies"></a></dt>
<dd><p>Logical indicating whether to show anomaly annotations using
line type differences in boxplot borders.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A ggplot2 object ready for display, or NULL if no genes meet selection criteria.
  The returned plot contains:</p><ul><li><p>Left panel: Expression boxplots with dataset-specific fill colors</p></li>
<li><p>Right panel: PC loading scatter points with PC-specific colors/shapes</p></li>
<li><p>Gene labels on y-axis with significance indicators (*)</p></li>
<li><p>P-value annotations on secondary y-axis</p></li>
<li><p>Legend showing dataset, PC information, and anomaly status (if applicable)</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function generates a dual-panel ggplot2 visualization where the left panel
shows horizontal boxplots of gene expression distributions comparing Reference
and Query datasets, while the right panel displays PC loading values as points
with adjusted p-values. Gene selection is based on the union of top genes
across specified principal components.</p>
<p>When anomaly information is available and requested, anomalous cells are
distinguished using dashed boxplot borders (normal cells have solid borders).
This approach avoids color conflicts between dataset identification (fill colors)
and PC identification (point colors/shapes).</p>
<p>Visual encoding:</p><ul><li><p>Dataset: Fill colors (Reference = blue, Query = red)</p></li>
<li><p>Anomaly status: Line types (Normal = solid, Anomaly = dashed borders)</p></li>
<li><p>PC identity: Point colors and shapes in loading panel</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plotHeatmap.html">plotHeatmap</a></code>, <code><a href="calculateTopLoadingGeneShifts.html">plot.calculateTopLoadingGeneShiftsObject</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Anthony Christidis, <a href="mailto:anthony-alexander_christidis@hms.harvard.edu">anthony-alexander_christidis@hms.harvard.edu</a></p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Anthony Christidis, Andrew Ghazi, Smriti Chawla, Ludwig Geistlinger, Robert Gentleman.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

